package com.tpp.threat_perception_platform.controller;

import com.tpp.threat_perception_platform.param.MyParam;
import com.tpp.threat_perception_platform.response.ResponseResult;
import com.tpp.threat_perception_platform.service.SystemVulnerabilityService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.parameters.P;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class SystemVulnerabilityController {

    @Autowired
    private SystemVulnerabilityService systemVulnerabilityService;

    /**
     * 查询系统漏洞列表
     *
     * @param myParam 查询参数
     * @return 漏洞列表
     */
    @PostMapping("/systemVulnerability/list")
    public ResponseResult findSystemVulnerabilityList(MyParam myParam) {
        return systemVulnerabilityService.findSystemVulnerabilityList(myParam);
    }

    /**
     * 删除系统漏洞
     *
     * @param ids 漏洞id
     * @return 删除结果
     */
    @PostMapping("/systemVulnerability/delete")
    public ResponseResult deleteSystemVulnerability(@RequestParam("ids[]") Integer[] ids) {
        return systemVulnerabilityService.deleteSystemVulnerability(ids);
    }

}
